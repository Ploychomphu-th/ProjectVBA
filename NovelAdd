Private Sub btnAdd_Click()
    Dim ws As Worksheet
    Dim bookTable As ListObject
    Dim found As Boolean
    Dim i As Long
    
    ' Set the worksheet and table
    Set ws = ThisWorkbook.Sheets("Stock")
    Set bookTable = ws.ListObjects("Book") ' The table name must match exactly
    
    found = False
    
    ' Check if the Book ID already exists
    For i = 1 To bookTable.ListRows.Count
        If bookTable.ListRows(i).Range.Cells(1, 1).Value = txtBookID.Value Then
            MsgBox "The Book ID already exists!", vbExclamation
            found = True
            Exit For
        End If
    Next i
    
    If Not found Then
        ' Add a new row
        bookTable.ListRows.Add
        With bookTable.ListRows(bookTable.ListRows.Count).Range
            .Cells(1, 1).Value = txtBookID.Value
            .Cells(1, 2).Value = txtTitle.Value
            .Cells(1, 3).Value = txtAuthor.Value
            .Cells(1, 4).Value = cboGenre.Value
            .Cells(1, 5).Value = cboLanguage.Value
            .Cells(1, 6).Value = txtRentalPrice.Value
            .Cells(1, 7).Value = txtStock.Value
        End With
        
        MsgBox "The book has been successfully added!", vbInformation
    End If
    
    ' Clear input fields
    txtBookID.Value = ""
    txtTitle.Value = ""
    txtAuthor.Value = ""
    cboGenre.Value = ""
    cboLanguage.Value = ""
    txtRentalPrice.Value = ""
    txtStock.Value = ""
    
    ' Hide the form
    
End Sub

Private Sub btnCancel_Click()
    ' Clear input fields
    txtBookID.Value = ""
    txtTitle.Value = ""
    txtAuthor.Value = ""
    cboGenre.Value = ""
    cboLanguage.Value = ""
    txtRentalPrice.Value = ""
    txtStock.Value = ""
    
    ' Close the form
    Me.Hide
End Sub



Private Sub UserForm_Initialize()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim rngGenre As Range, rngLanguage As Range
    Dim cell As Range
    Dim dictGenre As Object, dictLanguage As Object
    
    ' Set the sheet that contains the Table: Book
    Set ws = ThisWorkbook.Sheets("Stock") ' Change to the actual sheet name
    Set tbl = ws.ListObjects("Book") ' Change to the actual table name

    ' Use Dictionary to store unique values
    Set dictGenre = CreateObject("Scripting.Dictionary")
    Set dictLanguage = CreateObject("Scripting.Dictionary")

    ' Retrieve Genre values
    Set rngGenre = tbl.ListColumns("Genre").DataBodyRange
    For Each cell In rngGenre
        If Not dictGenre.exists(cell.Value) Then
            dictGenre.Add cell.Value, Nothing
            Me.cboGenre.AddItem cell.Value
        End If
    Next cell

    ' Retrieve Language values
    Set rngLanguage = tbl.ListColumns("Language").DataBodyRange
    For Each cell In rngLanguage
        If Not dictLanguage.exists(cell.Value) Then
            dictLanguage.Add cell.Value, Nothing
            Me.cboLanguage.AddItem cell.Value
        End If
    Next cell

    ' Clean up variables
    Set dictGenre = Nothing
    Set dictLanguage = Nothing
End Sub

