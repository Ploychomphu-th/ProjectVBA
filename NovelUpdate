Private Sub txtUpdateBookID_Change()
    Dim ws As Worksheet
    Dim bookTable As ListObject
    Dim found As Boolean
    Dim i As Long
    Dim bookID As String
    
    ' Set the Worksheet and Table "Stock"
    Set ws = ThisWorkbook.Sheets("Stock")
    Set bookTable = ws.ListObjects("Book")
    
    bookID = txtUpdateBookID.Value
    found = False
    
    ' Search the table for Book ID
    For i = 1 To bookTable.ListRows.Count
        If bookTable.ListRows(i).Range.Cells(1, 1).Value = bookID Then
            found = True
            ' Populate fields with existing values
            txtTitle.Value = bookTable.ListRows(i).Range.Cells(1, 2).Value
            txtAuthor.Value = bookTable.ListRows(i).Range.Cells(1, 3).Value
            cboGenre.Value = bookTable.ListRows(i).Range.Cells(1, 4).Value
            cboLanguage.Value = bookTable.ListRows(i).Range.Cells(1, 5).Value
            txtRentalPrice.Value = bookTable.ListRows(i).Range.Cells(1, 6).Value
            txtStock.Value = bookTable.ListRows(i).Range.Cells(1, 7).Value
            Exit For
        End If
    Next i
    
End Sub

Private Sub btnUpdate_Click()
    Dim ws As Worksheet
    Dim bookTable As ListObject
    Dim i As Long
    Dim bookID As String
    
    ' Set the Worksheet and Table "Stock"
    Set ws = ThisWorkbook.Sheets("Stock")
    Set bookTable = ws.ListObjects("Book")
    
    bookID = txtUpdateBookID.Value
    
    ' Search the table for Book ID
    For i = 1 To bookTable.ListRows.Count
        If bookTable.ListRows(i).Range.Cells(1, 1).Value = bookID Then
            ' Update the details in the table
            bookTable.ListRows(i).Range.Cells(1, 2).Value = txtTitle.Value
            bookTable.ListRows(i).Range.Cells(1, 3).Value = txtAuthor.Value
            bookTable.ListRows(i).Range.Cells(1, 4).Value = IIf(cboGenre.Value <> "", cboGenre.Value, "General")
            bookTable.ListRows(i).Range.Cells(1, 5).Value = IIf(cboLanguage.Value <> "", cboLanguage.Value, "English")
            bookTable.ListRows(i).Range.Cells(1, 6).Value = txtRentalPrice.Value
            bookTable.ListRows(i).Range.Cells(1, 7).Value = txtStock.Value
            
            MsgBox "Update successful!", vbInformation
            Exit Sub
        End If
    Next i
    
    MsgBox "Book ID not found!", vbExclamation
End Sub

Private Sub btnCancel_Click()
    ' Clear all fields and hide the UserForm
    txtUpdateBookID.Value = ""
    txtTitle.Value = ""
    txtAuthor.Value = ""
    cboGenre.Value = ""
    cboLanguage.Value = ""
    txtRentalPrice.Value = ""
    txtStock.Value = ""
    Me.Hide
End Sub

Private Sub UserForm_Initialize()
    ' Populate ComboBox for Genre
    Me.cboGenre.AddItem "Fiction"
    Me.cboGenre.AddItem "Non-Fiction"
    Me.cboGenre.AddItem "Sci-Fi"
    Me.cboGenre.AddItem "Romance"
    
    ' Populate ComboBox for Language
    Me.cboLanguage.AddItem "English"
    Me.cboLanguage.AddItem "Thai"
    Me.cboLanguage.AddItem "Japanese"
    Me.cboLanguage.AddItem "Chinese"
End Sub

