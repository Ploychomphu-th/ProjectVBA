Private Sub txtUpdateBookID_Change()
    Dim ws As Worksheet
    Dim bookTable As ListObject
    Dim found As Boolean
    Dim i As Long
    Dim bookID As String
    
    ' Set the Worksheet and Table "Stock"
    Set ws = ThisWorkbook.Sheets("Stock")
    Set bookTable = ws.ListObjects("Book")
    
    bookID = txtUpdateBookID.Value
    found = False
    
    ' Search the table for Book ID
    For i = 1 To bookTable.ListRows.Count
        If bookTable.ListRows(i).Range.Cells(1, 1).Value = bookID Then
            found = True
            ' Populate fields with existing values
            txtTitle.Value = bookTable.ListRows(i).Range.Cells(1, 2).Value
            txtAuthor.Value = bookTable.ListRows(i).Range.Cells(1, 3).Value
            cboGenre.Value = bookTable.ListRows(i).Range.Cells(1, 4).Value
            cboLanguage.Value = bookTable.ListRows(i).Range.Cells(1, 5).Value
            txtRentalPrice.Value = bookTable.ListRows(i).Range.Cells(1, 6).Value
            txtStock.Value = bookTable.ListRows(i).Range.Cells(1, 7).Value
            Exit For
        End If
    Next i
    
End Sub

Private Sub btnUpdate_Click()
    Dim ws As Worksheet
    Dim bookTable As ListObject
    Dim i As Long
    Dim bookID As String
    
    ' Set the Worksheet and Table "Stock"
    Set ws = ThisWorkbook.Sheets("Stock")
    Set bookTable = ws.ListObjects("Book")
    
    bookID = txtUpdateBookID.Value
    
    ' Search the table for Book ID
    For i = 1 To bookTable.ListRows.Count
        If bookTable.ListRows(i).Range.Cells(1, 1).Value = bookID Then
            ' Update the details in the table
            bookTable.ListRows(i).Range.Cells(1, 2).Value = txtTitle.Value
            bookTable.ListRows(i).Range.Cells(1, 3).Value = txtAuthor.Value
            bookTable.ListRows(i).Range.Cells(1, 4).Value = IIf(cboGenre.Value <> "", cboGenre.Value, "General")
            bookTable.ListRows(i).Range.Cells(1, 5).Value = IIf(cboLanguage.Value <> "", cboLanguage.Value, "English")
            bookTable.ListRows(i).Range.Cells(1, 6).Value = txtRentalPrice.Value
            bookTable.ListRows(i).Range.Cells(1, 7).Value = txtStock.Value
            
            MsgBox "Update successful!", vbInformation
            Exit Sub
        End If
    Next i
    
    MsgBox "Book ID not found!", vbExclamation
End Sub

Private Sub btnCancel_Click()
    ' Clear all fields and hide the UserForm
    txtUpdateBookID.Value = ""
    txtTitle.Value = ""
    txtAuthor.Value = ""
    cboGenre.Value = ""
    cboLanguage.Value = ""
    txtRentalPrice.Value = ""
    txtStock.Value = ""
    Me.Hide
End Sub

Private Sub UserForm_Initialize()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim rngGenre As Range, rngLanguage As Range
    Dim cell As Range
    Dim dictGenre As Object, dictLanguage As Object
    
    ' Set the sheet that contains the Table: Book
    Set ws = ThisWorkbook.Sheets("Stock") ' Change to the actual sheet name
    Set tbl = ws.ListObjects("Book") ' Change to the actual table name

    ' Use Dictionary to store unique values
    Set dictGenre = CreateObject("Scripting.Dictionary")
    Set dictLanguage = CreateObject("Scripting.Dictionary")

    ' Retrieve Genre values
    Set rngGenre = tbl.ListColumns("Genre").DataBodyRange
    For Each cell In rngGenre
        If Not dictGenre.exists(cell.Value) Then
            dictGenre.Add cell.Value, Nothing
            Me.cboGenre.AddItem cell.Value
        End If
    Next cell

    ' Retrieve Language values
    Set rngLanguage = tbl.ListColumns("Language").DataBodyRange
    For Each cell In rngLanguage
        If Not dictLanguage.exists(cell.Value) Then
            dictLanguage.Add cell.Value, Nothing
            Me.cboLanguage.AddItem cell.Value
        End If
    Next cell

    ' Clean up variables
    Set dictGenre = Nothing
    Set dictLanguage = Nothing
End Sub


